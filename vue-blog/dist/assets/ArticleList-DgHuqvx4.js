import{r as h,X as $,j as ee,l as te,k as ae,c as u,o as r,b as o,a as n,w as d,H as se,d as p,h as g,Y as oe,J as S,F as z,n as R,z as le,K as ne,u as ie,e as x,x as q,g as D,t as f,y as re,Z as de,R as ce,T as ue,D as ge}from"./index-cinz6B6s.js";import{g as me}from"./article-DZlkEKLi.js";import{g as pe}from"./category-DC1fMhQ_.js";import{g as fe}from"./tag-Dgbkx-o3.js";import{g as _e,f as ye,a as K}from"./helpers-YoB15h0M.js";import{s as ve}from"./seo-BkU-ml2H.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ke={class:"article-list-page"},Ie={class:"search-section"},we={class:"search-container"},Ce={class:"search-box"},be={class:"filter-container"},Ae={class:"filter-row"},Te={class:"filter-item"},Ve={class:"filter-item"},Se={class:"filter-item"},ze={class:"filter-actions"},Re={class:"articles-section"},xe={class:"articles-container"},Ne={key:0,class:"loading-container"},Ue={key:1,class:"empty-state"},je={key:2,class:"articles-list"},Be=["onClick"],De={key:0,class:"article-cover"},Le=["src","alt"],Pe={class:"article-content"},Oe={class:"article-title"},Ee={class:"article-summary"},Fe={class:"article-meta"},Je={class:"meta-item"},Me={class:"meta-item"},$e={class:"meta-item"},qe={class:"meta-item"},Ke={key:0,class:"article-tags"},He={key:0,class:"more-tags"},Qe={key:0,class:"pagination-container"},Xe={__name:"ArticleList",setup(Ye){const C=ie(),L=le(),b=h([]),k=h([]),_=h([]),N=h(!1),A=h(0),l=$({keyword:"",categoryId:"",tagId:"",timeRange:""}),c=$({page:1,pageSize:10});ee(()=>l.keyword||l.categoryId||l.tagId||l.timeRange);const T=h([]),I=async()=>{N.value=!0;try{const t={};l.keyword&&(t.title=l.keyword),l.categoryId&&(t.categoryId=l.categoryId),l.tagId&&(t.tagId=l.tagId);const e=await me(t);let s=[];e&&e.data?Array.isArray(e.data)?s=e.data:e.data.list&&Array.isArray(e.data.list)?s=e.data.list:Array.isArray(e.data.records)?s=e.data.records:s=[]:Array.isArray(e)?s=e:s=[],s=s.filter(i=>i.id!==1&&i.id!=="1"),s.sort((i,y)=>{const m=i.isTop===1||i.isTop===!0,v=y.isTop===1||y.isTop===!0;if(m&&!v)return-1;if(!m&&v)return 1;const B=new Date(i.createTime||i.createdAt||0).getTime();return new Date(y.createTime||y.createdAt||0).getTime()-B}),T.value=s,A.value=s.length,j()}catch{ne.error("加载文章列表失败"),T.value=[],b.value=[],A.value=0}finally{N.value=!1}},P=async()=>{try{const e=(await pe()).data||[];k.value=e.filter(s=>s.articleCount>0)}catch{k.value=[{id:1,name:"技术"},{id:2,name:"生活"},{id:3,name:"随笔"}]}},O=async()=>{try{const t=await fe();_.value=t.data||[]}catch{_.value=[{id:1,name:"Vue3"},{id:2,name:"前端"},{id:3,name:"Element Plus"},{id:4,name:"JavaScript"}]}},U=()=>{c.page=1,I()},V=()=>{c.page=1,I()},E=()=>{Object.assign(l,{keyword:"",categoryId:"",tagId:"",timeRange:""}),c.page=1,I()},j=()=>{const t=(c.page-1)*c.pageSize,e=t+c.pageSize;b.value=T.value.slice(t,e)},H=t=>{c.pageSize=t,c.page=1,j()},Q=t=>{c.page=t,j()},X=t=>{if(typeof t=="object"&&t!==null){const e=t.slug||t.id;C.push({name:"ArticleDetail",params:{id:e}})}else C.push({name:"ArticleDetail",params:{id:t}})},F=t=>{if(typeof t=="object"&&t!==null)return t.name;const e=_.value.find(s=>s.id===t);return e?e.name:t},Y=t=>{const e=_.value.find(s=>s.name===t);if(e)C.push(`/tag/${e.id}`);else{const s=T.value.flatMap(i=>i.tags||[]).find(i=>typeof i=="object"&&i!==null?i.name===t:!1);s&&typeof s=="object"?C.push(`/tag/${s.id}`):(l.tagId="",V())}},J=()=>{const t=L.query;if(t.tagId)l.tagId=t.tagId;else if(t.tag){const e=decodeURIComponent(t.tag),s=_.value.find(i=>i.name===e);s?l.tagId=s.id:l.tagId=e}if(t.categoryId)l.categoryId=t.categoryId;else if(t.category){const e=decodeURIComponent(t.category),s=k.value.find(i=>i.name===e);s&&(l.categoryId=s.id)}t.keyword&&(l.keyword=decodeURIComponent(t.keyword)),t.timeRange&&(l.timeRange=t.timeRange)},Z=()=>{ve({title:"文章列表",description:"探索我们的精彩文章，发现新的知识和见解",keywords:["文章","博客","技术","前端","Vue3"],structuredData:{"@context":"https://schema.org","@type":"CollectionPage",name:"文章列表",description:"探索我们的精彩文章，发现新的知识和见解",url:window.location.href}})};return te(async()=>{Z(),await Promise.all([P(),O()]),J(),I()}),ae(()=>L.query,async(t,e)=>{JSON.stringify(t)!==JSON.stringify(e)&&((k.value.length===0||_.value.length===0)&&await Promise.all([P(),O()]),J(),I())},{deep:!0}),(t,e)=>{const s=p("el-icon"),i=p("el-button"),y=p("el-input"),m=p("el-option"),v=p("el-select"),B=p("el-skeleton"),M=p("el-empty"),G=p("el-tag"),W=p("el-pagination");return r(),u("div",ke,[e[12]||(e[12]=o("div",{class:"page-header"},[o("div",{class:"header-content"},[o("h1",{class:"page-title"},"文章列表"),o("p",{class:"page-description"},"探索我们的精彩文章，发现新的知识和见解")])],-1)),o("div",Ie,[o("div",we,[o("div",Ce,[n(y,{modelValue:l.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>l.keyword=a),placeholder:"搜索文章标题、内容或标签...",size:"large",clearable:"",onKeyup:se(U,["enter"]),onClear:U},{prefix:d(()=>[n(s,null,{default:d(()=>[n(g(q))]),_:1})]),append:d(()=>[n(i,{onClick:U,type:"primary"},{default:d(()=>[n(s,null,{default:d(()=>[n(g(q))]),_:1}),e[6]||(e[6]=x(" 搜索 ",-1))]),_:1})]),_:1},8,["modelValue"])]),o("div",be,[o("div",Ae,[o("div",Te,[e[7]||(e[7]=o("label",{class:"filter-label"},"分类",-1)),n(v,{modelValue:l.categoryId,"onUpdate:modelValue":e[1]||(e[1]=a=>l.categoryId=a),placeholder:"选择分类",clearable:"",onChange:V,class:"filter-select"},{default:d(()=>[(r(!0),u(z,null,R(k.value,a=>(r(),D(m,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),o("div",Ve,[e[8]||(e[8]=o("label",{class:"filter-label"},"标签",-1)),n(v,{modelValue:l.tagId,"onUpdate:modelValue":e[2]||(e[2]=a=>l.tagId=a),placeholder:"选择标签",clearable:"",onChange:V,class:"filter-select"},{default:d(()=>[(r(!0),u(z,null,R(_.value,a=>(r(),D(m,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),o("div",Se,[e[9]||(e[9]=o("label",{class:"filter-label"},"时间",-1)),n(v,{modelValue:l.timeRange,"onUpdate:modelValue":e[3]||(e[3]=a=>l.timeRange=a),placeholder:"时间范围",onChange:V,class:"filter-select"},{default:d(()=>[n(m,{label:"全部时间",value:""}),n(m,{label:"最近一周",value:"week"}),n(m,{label:"最近一月",value:"month"}),n(m,{label:"最近一年",value:"year"})]),_:1},8,["modelValue"])]),o("div",ze,[n(i,{onClick:E,icon:g(oe)},{default:d(()=>[...e[10]||(e[10]=[x("重置",-1)])]),_:1},8,["icon"])])])])])]),o("div",Re,[o("div",xe,[N.value?(r(),u("div",Ne,[n(B,{rows:5,animated:""})])):b.value.length===0?(r(),u("div",Ue,[n(M,{description:"暂无文章"},{default:d(()=>[n(i,{type:"primary",onClick:E},{default:d(()=>[...e[11]||(e[11]=[x("查看全部文章",-1)])]),_:1})]),_:1})])):(r(),u("div",je,[(r(!0),u(z,null,R(b.value,a=>(r(),u("div",{key:a.id,class:"article-card",onClick:w=>X(a)},[a.coverImage||a.cover?(r(),u("div",De,[o("img",{src:a.coverImage||a.cover,alt:a.title,class:"cover-image"},null,8,Le)])):S("",!0),o("div",Pe,[o("h2",Oe,f(a.title),1),o("p",Ee,f(a.summary||g(_e)(a.content)),1),o("div",Fe,[o("div",Je,[n(s,null,{default:d(()=>[n(g(re))]),_:1}),o("span",null,f(a.authorName||a.author),1)]),o("div",Me,[n(s,null,{default:d(()=>[n(g(de))]),_:1}),o("span",null,f(g(ye)(a.createTime||a.createdAt)),1)]),o("div",$e,[n(s,null,{default:d(()=>[n(g(ce))]),_:1}),o("span",null,f(g(K)(a.viewCount||a.views||0)),1)]),o("div",qe,[n(s,null,{default:d(()=>[n(g(ue))]),_:1}),o("span",null,f(g(K)(a.commentCount||a.comments||0)),1)])]),a.tags&&a.tags.length>0?(r(),u("div",Ke,[(r(!0),u(z,null,R(a.tags.slice(0,3),w=>(r(),D(G,{key:w.id||w,size:"small",type:"info",class:"tag-item",onClick:ge(Ze=>Y(F(w)),["stop"])},{default:d(()=>[x(f(F(w)),1)]),_:2},1032,["onClick"]))),128)),a.tags.length>3?(r(),u("span",He," +"+f(a.tags.length-3),1)):S("",!0)])):S("",!0)])],8,Be))),128))]))]),A.value>0?(r(),u("div",Qe,[n(W,{"current-page":c.page,"onUpdate:currentPage":e[4]||(e[4]=a=>c.page=a),"page-size":c.pageSize,"onUpdate:pageSize":e[5]||(e[5]=a=>c.pageSize=a),"page-sizes":[10,20,50,100],total:A.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:H,onCurrentChange:Q},null,8,["current-page","page-size","total"])])):S("",!0)])])}}},lt=he(Xe,[["__scopeId","data-v-418e4a44"]]);export{lt as default};
