import{a2 as R,r as V,i as q,j,l as D,c as x,o as g,b as t,g as P,J as I,a as e,e as p,w as r,h as i,q as M,d as u,a3 as Y,F as Z,n as ee,t as E,X as te,a4 as se,a5 as ae,a6 as re,K as w,C as oe,a7 as z,a8 as le,a9 as ne,aa as de,ab as ie,v as ue}from"./index-Cr_Or7lo.js";import{b as ge}from"./helpers-DVd64Rx3.js";import{a as N}from"./avatar-Br5af8Id.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";const A={getLinks(_={}){return R.get("/user/links",{params:_})},applyLink(_){return R.post("/user/links/apply",_)},getUpdates(_={}){return R.get("/user/updates",{params:_})}},ce={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},me={class:"flex items-center justify-between mb-6"},pe={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},_e={key:0,class:"flex justify-center py-8"},fe={key:1,class:"text-center text-gray-500 dark:text-gray-400 py-8"},ve={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},ye=["href"],xe=["src","alt"],be={class:"flex-1 min-w-0"},ke={class:"font-medium text-gray-900 dark:text-gray-100 group-hover:text-primary truncate"},he={key:0,class:"text-sm text-gray-500 dark:text-gray-400 line-clamp-2 mt-1"},we={__name:"FriendLinks",setup(_){const f=V(!1),c=V([]),b=q(),k=j(()=>b.userInfo?.isAdmin||!1),v=async()=>{f.value=!0;try{const s=await A.getLinks({status:0});c.value=s.data||[]}catch{const d=[{id:1,name:"Vue.js",description:"渐进式JavaScript框架",url:"https://vuejs.org",avatar:"https://vuejs.org/images/logo.png",status:0},{id:2,name:"Element Plus",description:"基于Vue 3的桌面端组件库",url:"https://element-plus.org",avatar:"https://element-plus.org/images/element-plus-logo-small.svg",status:0}];c.value=d}finally{f.value=!1}},$=s=>ge(s,N),a=s=>{s.target.src=N};return D(()=>{v()}),(s,d)=>{const h=u("el-icon"),L=u("el-button");return g(),x("div",ce,[t("div",me,[t("h3",pe,[e(h,{class:"mr-2"},{default:r(()=>[e(i(M))]),_:1}),d[1]||(d[1]=p(" 友情链接 ",-1))]),k.value?(g(),P(L,{key:0,size:"small",type:"primary",plain:"",onClick:d[0]||(d[0]=m=>s.$router.push("/admin/links"))},{default:r(()=>[...d[2]||(d[2]=[p(" 管理友链 ",-1)])]),_:1})):I("",!0)]),f.value?(g(),x("div",_e,[e(h,{class:"is-loading text-2xl"},{default:r(()=>[e(i(Y))]),_:1})])):c.value.length===0?(g(),x("div",fe," 暂无友情链接 ")):(g(),x("div",ve,[(g(!0),x(Z,null,ee(c.value,m=>(g(),x("a",{key:m.id,href:m.url,target:"_blank",rel:"noopener noreferrer",class:"group flex items-center p-4 bg-gray-50 dark:bg-gray-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors"},[t("img",{src:$(m.avatar),alt:m.name,class:"w-12 h-12 rounded-full object-cover mr-4 flex-shrink-0 border border-gray-200 dark:border-gray-600",onError:a},null,40,xe),t("div",be,[t("h4",ke,E(m.name),1),m.description?(g(),x("p",he,E(m.description),1)):I("",!0)])],8,ye))),128))]))])}}},Ve=B(we,[["__scopeId","data-v-10ef6a99"]]),$e={class:"flex items-center space-x-4"},Le={key:0,class:"flex-shrink-0"},Ue={class:"relative"},Se=["src"],je={class:"absolute inset-0 w-16 h-16 rounded-lg border border-gray-200 bg-gray-100 flex items-center justify-center text-gray-400",style:{display:"none"}},Ee={class:"flex-1"},Ae={class:"mt-2"},Fe={class:"dialog-footer"},Ce={__name:"LinkApplyDialog",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","success"],setup(_,{emit:f}){const c=_,b=f,k=j({get:()=>c.modelValue,set:l=>b("update:modelValue",l)}),v=V(),$=V(),a=V(!1),s=te({name:"",description:"",url:"",avatar:""}),d={name:[{required:!0,message:"请输入网站名称",trigger:"blur"},{min:2,max:48,message:"网站名称长度在 2 到 48 个字符",trigger:"blur"}],description:[{max:255,message:"网站描述不能超过 255 个字符",trigger:"blur"}],url:[{required:!0,message:"请输入网站地址",trigger:"blur"},{pattern:/^https?:\/\/.+/,message:"请输入有效的网站地址，如：https://example.com",trigger:"blur"}],avatar:[{validator:(l,o,n)=>{if(!o||o.trim()===""){n();return}const U=/^https?:\/\/.+/,S=/\.(jpg|jpeg|png|gif|webp)$/i;U.test(o)?S.test(o)?n():n(new Error("请输入有效的图片URL地址（支持 jpg、jpeg、png、gif、webp 格式）")):n(new Error("请输入有效的URL地址，如：https://example.com/logo.png"))},trigger:"blur"}]},h=q(),L=j(()=>se("/common/upload")),m=j(()=>{const l=h.token;return l?{Authorization:`Bearer ${l}`}:{}}),G=l=>{const o=l.type.startsWith("image/"),n=l.size/1024/1024<2;return o?n?!0:(w.error("图片大小不能超过 2MB!"),!1):(w.error("只能上传图片文件!"),!1)},J=l=>{l.code===200?(s.avatar=l.data.url,w.success("图片上传成功")):w.error(l.msg||"图片上传失败")},H=l=>{w.error("图片上传失败，请重试")},K=l=>{l.target.style.display="none",l.target.nextElementSibling&&(l.target.nextElementSibling.style.display="block")},T=()=>{s.name="",s.description="",s.url="",s.avatar="",v.value&&v.value.resetFields()},F=()=>{T(),k.value=!1},W=async()=>{if(v.value)try{await v.value.validate(),a.value=!0;const l=s.avatar?String(s.avatar).trim():"",o={name:s.name,description:s.description||"",url:s.url,avatar:l,status:1},n=await A.applyLink(o);n.code===200?(w.success("友链申请提交成功，请等待审核"),b("success"),F()):w.error(n.msg||"申请提交失败")}catch{w.error("申请提交失败，请重试")}finally{a.value=!1}};return(l,o)=>{const n=u("el-input"),U=u("el-form-item"),S=u("el-icon"),C=u("el-button"),X=u("el-upload"),O=u("el-form"),Q=u("el-dialog");return g(),P(Q,{modelValue:k.value,"onUpdate:modelValue":o[4]||(o[4]=y=>k.value=y),title:"申请友链",width:"600px","before-close":F,"destroy-on-close":""},{footer:r(()=>[t("div",Fe,[e(C,{onClick:F},{default:r(()=>[...o[7]||(o[7]=[p("取消",-1)])]),_:1}),e(C,{type:"primary",loading:a.value,onClick:W},{default:r(()=>[...o[8]||(o[8]=[p(" 提交申请 ",-1)])]),_:1},8,["loading"])])]),default:r(()=>[e(O,{ref_key:"formRef",ref:v,model:s,rules:d,"label-width":"100px","label-position":"left"},{default:r(()=>[e(U,{label:"网站名称",prop:"name"},{default:r(()=>[e(n,{modelValue:s.name,"onUpdate:modelValue":o[0]||(o[0]=y=>s.name=y),placeholder:"请输入网站名称",maxlength:"48","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(U,{label:"网站描述",prop:"description"},{default:r(()=>[e(n,{modelValue:s.description,"onUpdate:modelValue":o[1]||(o[1]=y=>s.description=y),type:"textarea",rows:3,placeholder:"请输入网站描述",maxlength:"255","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(U,{label:"网站地址",prop:"url"},{default:r(()=>[e(n,{modelValue:s.url,"onUpdate:modelValue":o[2]||(o[2]=y=>s.url=y),placeholder:"请输入网站地址，如：https://example.com"},null,8,["modelValue"])]),_:1}),e(U,{label:"网站图标",prop:"avatar"},{default:r(()=>[t("div",$e,[s.avatar?(g(),x("div",Le,[t("div",Ue,[t("img",{src:s.avatar,alt:"网站图标",class:"w-16 h-16 rounded-lg object-cover border border-gray-200",onError:K},null,40,Se),t("div",je,[e(S,{size:"24"},{default:r(()=>[e(i(ae))]),_:1})])])])):I("",!0),t("div",Ee,[e(X,{ref_key:"uploadRef",ref:$,action:L.value,headers:m.value,"show-file-list":!1,"before-upload":G,"on-success":J,"on-error":H,accept:"image/*",class:"upload-demo"},{default:r(()=>[e(C,{type:"primary",plain:""},{default:r(()=>[e(S,{class:"mr-1"},{default:r(()=>[e(i(re))]),_:1}),o[5]||(o[5]=p(" 上传图标 ",-1))]),_:1})]),_:1},8,["action","headers"]),t("div",Ae,[e(n,{modelValue:s.avatar,"onUpdate:modelValue":o[3]||(o[3]=y=>s.avatar=y),placeholder:"或直接输入图标URL地址",size:"small"},null,8,["modelValue"])])])]),o[6]||(o[6]=t("div",{class:"text-xs text-gray-500 mt-1",style:{"margin-bottom":"42px"}}," 支持 JPG、PNG、GIF 格式，建议尺寸 64x64 像素 ",-1))]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}},Re=B(Ce,[["__scopeId","data-v-c312da38"]]),Ie={class:"min-h-screen bg-gray-50 dark:bg-gray-900"},Be={class:"bg-white dark:bg-gray-800 shadow-sm"},ze={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Ne={class:"text-center"},qe={class:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-4"},De={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Pe={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},Me={class:"lg:col-span-2"},Ge={class:"space-y-6"},Je={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},He={class:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4"},Ke={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},Te={class:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4"},We={class:"grid grid-cols-2 gap-4"},Xe={class:"text-center"},Oe={class:"text-2xl font-bold text-primary"},Qe={class:"text-center"},Ye={class:"text-2xl font-bold text-green-500"},Ze={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},et={class:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4"},tt={class:"space-y-2"},st={__name:"FriendLinks",setup(_){const f=V(0),c=V(0),b=V(!1),k=async()=>{try{const $=await A.getLinks({status:0});c.value=$.data?.length||0;const a=await A.getLinks();f.value=a.data?.length||0}catch{f.value=12,c.value=10}},v=()=>{k()};return D(()=>{k()}),($,a)=>{const s=u("el-icon"),d=u("el-button"),h=u("router-link");return g(),x("div",Ie,[t("div",Be,[t("div",ze,[t("div",Ne,[t("h1",qe,[e(s,{class:"mr-3 text-primary"},{default:r(()=>[e(i(M))]),_:1}),a[2]||(a[2]=p(" 友情链接 ",-1))]),a[3]||(a[3]=t("p",{class:"text-lg text-gray-600 dark:text-gray-400 max-w-2xl mx-auto"}," 这里是我的友链，希望能为您提供更多有价值的内容 ",-1))])])]),t("div",De,[t("div",Pe,[t("div",Me,[e(Ve)]),t("div",Ge,[t("div",Je,[t("h3",He,[e(s,{class:"mr-2"},{default:r(()=>[e(i(z))]),_:1}),a[4]||(a[4]=p(" 申请友链 ",-1))]),a[6]||(a[6]=t("p",{class:"text-gray-600 dark:text-gray-400 mb-4"}," 如果您希望与本站建立友情链接，请填写以下信息： ",-1)),e(d,{type:"primary",size:"large",class:"w-full mb-4",onClick:a[0]||(a[0]=L=>b.value=!0)},{default:r(()=>[e(s,{class:"mr-2"},{default:r(()=>[e(i(z))]),_:1}),a[5]||(a[5]=p(" 立即申请友链 ",-1))]),_:1}),a[7]||(a[7]=oe('<div class="mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg" data-v-68378b40><h4 class="font-medium text-blue-900 dark:text-blue-100 mb-2" data-v-68378b40>申请要求：</h4><ul class="text-sm text-blue-800 dark:text-blue-200 space-y-1" data-v-68378b40><li data-v-68378b40>• 网站内容健康向上</li><li data-v-68378b40>• 网站正常运行</li><li data-v-68378b40>• 愿意互加友链</li><li data-v-68378b40>• 提供网站名称、描述和头像</li></ul></div><div class="mt-4 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg" data-v-68378b40><h4 class="font-medium text-gray-900 dark:text-gray-100 mb-2" data-v-68378b40>其他联系方式：</h4><div class="space-y-1 text-sm text-gray-600 dark:text-gray-400" data-v-68378b40><p data-v-68378b40><strong data-v-68378b40>邮箱：</strong> L3542495583@outlook.com</p></div></div>',2))]),t("div",Ke,[t("h3",Te,[e(s,{class:"mr-2"},{default:r(()=>[e(i(le))]),_:1}),a[8]||(a[8]=p(" 友链统计 ",-1))]),t("div",We,[t("div",Xe,[t("div",Oe,E(f.value),1),a[9]||(a[9]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"友链总数",-1))]),t("div",Qe,[t("div",Ye,E(c.value),1),a[10]||(a[10]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"活跃友链",-1))])])]),t("div",Ze,[t("h3",et,[e(s,{class:"mr-2"},{default:r(()=>[e(i(ne))]),_:1}),a[11]||(a[11]=p(" 快速导航 ",-1))]),t("div",tt,[e(h,{to:"/home",class:"flex items-center p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"},{default:r(()=>[e(s,{class:"mr-2 text-primary"},{default:r(()=>[e(i(de))]),_:1}),a[12]||(a[12]=t("span",{class:"text-gray-700 dark:text-gray-300"},"返回首页",-1))]),_:1}),e(h,{to:"/articles",class:"flex items-center p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"},{default:r(()=>[e(s,{class:"mr-2 text-primary"},{default:r(()=>[e(i(ie))]),_:1}),a[13]||(a[13]=t("span",{class:"text-gray-700 dark:text-gray-300"},"浏览文章",-1))]),_:1}),e(h,{to:"/about",class:"flex items-center p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"},{default:r(()=>[e(s,{class:"mr-2 text-primary"},{default:r(()=>[e(i(ue))]),_:1}),a[14]||(a[14]=t("span",{class:"text-gray-700 dark:text-gray-300"},"关于我",-1))]),_:1})])])])])]),e(Re,{modelValue:b.value,"onUpdate:modelValue":a[1]||(a[1]=L=>b.value=L),onSuccess:v},null,8,["modelValue"])])}}},nt=B(st,[["__scopeId","data-v-68378b40"]]);export{nt as default};
