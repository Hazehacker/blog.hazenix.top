import{_ as I,r as k,i as z,H as S,j as N,c as g,o as d,b as s,g as q,B as U,a as t,l as m,w as l,h as i,p as D,f as u,a7 as X,F as Y,C as Z,D as j,W as ee,a8 as te,a9 as se,E as b,d as ae,aa as R,ab as le,ac as oe,ad as re,a4 as ne,q as de}from"./index-1BlqOf3s.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";const E={getLinks(h={}){return I.get("/user/links",{params:h})},applyLink(h){return I.post("/user/links/apply",h)}},ie={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},ue={class:"flex items-center justify-between mb-6"},ce={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},ge={key:0,class:"flex justify-center py-8"},me={key:1,class:"text-center text-gray-500 dark:text-gray-400 py-8"},pe={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},fe=["href"],_e=["src","alt"],ye={class:"flex-1 min-w-0"},ve={class:"font-medium text-gray-900 dark:text-gray-100 group-hover:text-primary truncate"},xe={key:0,class:"text-sm text-gray-500 dark:text-gray-400 line-clamp-2 mt-1"},be={__name:"FriendLinks",setup(h){const p=k(!1),c=k([]),y=z(),v=S(()=>y.userInfo?.isAdmin||!1),f=async()=>{p.value=!0;try{const e=await E.getLinks({status:0});c.value=e.data||[]}catch(e){console.error("加载友链列表失败:",e);const a=[{id:1,name:"Vue.js",description:"渐进式JavaScript框架",url:"https://vuejs.org",avatar:"https://vuejs.org/images/logo.png",status:0},{id:2,name:"Element Plus",description:"基于Vue 3的桌面端组件库",url:"https://element-plus.org",avatar:"https://element-plus.org/images/element-plus-logo-small.svg",status:0}];c.value=a}finally{p.value=!1}},x=e=>{e.target.src="/default-avatar.png"};return N(()=>{f()}),(e,a)=>{const V=u("el-icon"),w=u("el-button");return d(),g("div",ie,[s("div",ue,[s("h3",ce,[t(V,{class:"mr-2"},{default:l(()=>[t(i(D))]),_:1}),a[1]||(a[1]=m(" 友情链接 ",-1))]),v.value?(d(),q(w,{key:0,size:"small",type:"primary",plain:"",onClick:a[0]||(a[0]=n=>e.$router.push("/admin/links"))},{default:l(()=>[...a[2]||(a[2]=[m(" 管理友链 ",-1)])]),_:1})):U("",!0)]),p.value?(d(),g("div",ge,[t(V,{class:"is-loading text-2xl"},{default:l(()=>[t(i(X))]),_:1})])):c.value.length===0?(d(),g("div",me," 暂无友情链接 ")):(d(),g("div",pe,[(d(!0),g(Y,null,Z(c.value,n=>(d(),g("a",{key:n.id,href:n.url,target:"_blank",rel:"noopener noreferrer",class:"group flex items-center p-4 bg-gray-50 dark:bg-gray-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors"},[n.avatar?(d(),g("img",{key:0,src:n.avatar,alt:n.name,class:"w-12 h-12 rounded-full object-cover mr-4 flex-shrink-0",onError:x},null,40,_e)):U("",!0),s("div",ye,[s("h4",ve,j(n.name),1),n.description?(d(),g("p",xe,j(n.description),1)):U("",!0)])],8,fe))),128))]))])}}},ke=A(be,[["__scopeId","data-v-a92def14"]]),he={class:"flex items-center space-x-4"},we={key:0,class:"flex-shrink-0"},Ve={class:"relative"},$e=["src"],Le={class:"absolute inset-0 w-16 h-16 rounded-lg border border-gray-200 bg-gray-100 flex items-center justify-center text-gray-400",style:{display:"none"}},Se={class:"flex-1"},Ue={class:"mt-2"},je={class:"dialog-footer"},Ee={__name:"LinkApplyDialog",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","success"],setup(h,{emit:p}){const c=h,y=p,v=S({get:()=>c.modelValue,set:o=>y("update:modelValue",o)}),f=k(),x=k(),e=k(!1),a=ee({name:"",description:"",url:"",avatar:""}),V={name:[{required:!0,message:"请输入网站名称",trigger:"blur"},{min:2,max:48,message:"网站名称长度在 2 到 48 个字符",trigger:"blur"}],description:[{max:255,message:"网站描述不能超过 255 个字符",trigger:"blur"}],url:[{required:!0,message:"请输入网站地址",trigger:"blur"},{pattern:/^https?:\/\/.+/,message:"请输入有效的网站地址，如：https://example.com",trigger:"blur"}],avatar:[{pattern:/^https?:\/\/.+\.(jpg|jpeg|png|gif|webp)$/i,message:"请输入有效的图片URL地址",trigger:"blur"}]},w=z(),n=S(()=>"/api/user/common/upload"),M=S(()=>{const o=w.token;return o?{Authorization:`Bearer ${o}`}:{}}),G=o=>{const r=o.type.startsWith("image/"),$=o.size/1024/1024<2;return r?$?!0:(b.error("图片大小不能超过 2MB!"),!1):(b.error("只能上传图片文件!"),!1)},P=o=>{o.code===200?(a.avatar=o.data.url,b.success("图片上传成功")):b.error(o.msg||"图片上传失败")},H=o=>{console.error("上传失败:",o),b.error("图片上传失败，请重试")},J=o=>{o.target.style.display="none",o.target.nextElementSibling&&(o.target.nextElementSibling.style.display="block")},W=()=>{a.name="",a.description="",a.url="",a.avatar="",f.value&&f.value.resetFields()},C=()=>{W(),v.value=!1},T=async()=>{if(f.value)try{await f.value.validate(),e.value=!0;const o=await E.applyLink({name:a.name,description:a.description,url:a.url,avatar:a.avatar,status:1});o.code===200?(b.success("友链申请提交成功，请等待审核"),y("success"),C()):b.error(o.msg||"申请提交失败")}catch(o){console.error("提交申请失败:",o),b.error("申请提交失败，请重试")}finally{e.value=!1}};return(o,r)=>{const $=u("el-input"),L=u("el-form-item"),B=u("el-icon"),F=u("el-button"),K=u("el-upload"),O=u("el-form"),Q=u("el-dialog");return d(),q(Q,{modelValue:v.value,"onUpdate:modelValue":r[4]||(r[4]=_=>v.value=_),title:"申请友链",width:"600px","before-close":C,"destroy-on-close":""},{footer:l(()=>[s("div",je,[t(F,{onClick:C},{default:l(()=>[...r[7]||(r[7]=[m("取消",-1)])]),_:1}),t(F,{type:"primary",loading:e.value,onClick:T},{default:l(()=>[...r[8]||(r[8]=[m(" 提交申请 ",-1)])]),_:1},8,["loading"])])]),default:l(()=>[t(O,{ref_key:"formRef",ref:f,model:a,rules:V,"label-width":"100px","label-position":"left"},{default:l(()=>[t(L,{label:"网站名称",prop:"name"},{default:l(()=>[t($,{modelValue:a.name,"onUpdate:modelValue":r[0]||(r[0]=_=>a.name=_),placeholder:"请输入网站名称",maxlength:"48","show-word-limit":""},null,8,["modelValue"])]),_:1}),t(L,{label:"网站描述",prop:"description"},{default:l(()=>[t($,{modelValue:a.description,"onUpdate:modelValue":r[1]||(r[1]=_=>a.description=_),type:"textarea",rows:3,placeholder:"请输入网站描述",maxlength:"255","show-word-limit":""},null,8,["modelValue"])]),_:1}),t(L,{label:"网站地址",prop:"url"},{default:l(()=>[t($,{modelValue:a.url,"onUpdate:modelValue":r[2]||(r[2]=_=>a.url=_),placeholder:"请输入网站地址，如：https://example.com"},null,8,["modelValue"])]),_:1}),t(L,{label:"网站图标",prop:"avatar"},{default:l(()=>[s("div",he,[a.avatar?(d(),g("div",we,[s("div",Ve,[s("img",{src:a.avatar,alt:"网站图标",class:"w-16 h-16 rounded-lg object-cover border border-gray-200",onError:J},null,40,$e),s("div",Le,[t(B,{size:"24"},{default:l(()=>[t(i(te))]),_:1})])])])):U("",!0),s("div",Se,[t(K,{ref_key:"uploadRef",ref:x,action:n.value,headers:M.value,"show-file-list":!1,"before-upload":G,"on-success":P,"on-error":H,accept:"image/*",class:"upload-demo"},{default:l(()=>[t(F,{type:"primary",plain:""},{default:l(()=>[t(B,{class:"mr-1"},{default:l(()=>[t(i(se))]),_:1}),r[5]||(r[5]=m(" 上传图标 ",-1))]),_:1})]),_:1},8,["action","headers"]),s("div",Ue,[t($,{modelValue:a.avatar,"onUpdate:modelValue":r[3]||(r[3]=_=>a.avatar=_),placeholder:"或直接输入图标URL地址",size:"small"},null,8,["modelValue"])])])]),r[6]||(r[6]=s("div",{class:"text-xs text-gray-500 mt-1",style:{"margin-bottom":"42px"}}," 支持 JPG、PNG、GIF 格式，建议尺寸 64x64 像素 ",-1))]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}},Ce=A(Ee,[["__scopeId","data-v-3c9633f8"]]),Fe={class:"min-h-screen bg-gray-50 dark:bg-gray-900"},Ae={class:"bg-white dark:bg-gray-800 shadow-sm"},Be={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Ie={class:"text-center"},Re={class:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-4"},ze={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Ne={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},qe={class:"lg:col-span-2"},De={class:"space-y-6"},Me={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},Ge={class:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4"},Pe={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},He={class:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4"},Je={class:"grid grid-cols-2 gap-4"},We={class:"text-center"},Te={class:"text-2xl font-bold text-primary"},Ke={class:"text-center"},Oe={class:"text-2xl font-bold text-green-500"},Qe={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},Xe={class:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4"},Ye={class:"space-y-2"},Ze={__name:"FriendLinks",setup(h){const p=k(0),c=k(0),y=k(!1),v=async()=>{try{const x=await E.getLinks({status:0});c.value=x.data?.length||0;const e=await E.getLinks();p.value=e.data?.length||0}catch(x){console.error("加载友链统计失败:",x),p.value=12,c.value=10}},f=()=>{v()};return N(()=>{v()}),(x,e)=>{const a=u("el-icon"),V=u("el-button"),w=u("router-link");return d(),g("div",Fe,[s("div",Ae,[s("div",Be,[s("div",Ie,[s("h1",Re,[t(a,{class:"mr-3 text-primary"},{default:l(()=>[t(i(D))]),_:1}),e[2]||(e[2]=m(" 友情链接 ",-1))]),e[3]||(e[3]=s("p",{class:"text-lg text-gray-600 dark:text-gray-400 max-w-2xl mx-auto"}," 这里是我的友链，希望能为您提供更多有价值的内容 ",-1))])])]),s("div",ze,[s("div",Ne,[s("div",qe,[t(ke)]),s("div",De,[s("div",Me,[s("h3",Ge,[t(a,{class:"mr-2"},{default:l(()=>[t(i(R))]),_:1}),e[4]||(e[4]=m(" 申请友链 ",-1))]),e[6]||(e[6]=s("p",{class:"text-gray-600 dark:text-gray-400 mb-4"}," 如果您希望与本站建立友情链接，请填写以下信息： ",-1)),t(V,{type:"primary",size:"large",class:"w-full mb-4",onClick:e[0]||(e[0]=n=>y.value=!0)},{default:l(()=>[t(a,{class:"mr-2"},{default:l(()=>[t(i(R))]),_:1}),e[5]||(e[5]=m(" 立即申请友链 ",-1))]),_:1}),e[7]||(e[7]=ae('<div class="mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg" data-v-6e9f755f><h4 class="font-medium text-blue-900 dark:text-blue-100 mb-2" data-v-6e9f755f>申请要求：</h4><ul class="text-sm text-blue-800 dark:text-blue-200 space-y-1" data-v-6e9f755f><li data-v-6e9f755f>• 网站内容健康向上</li><li data-v-6e9f755f>• 网站正常运行</li><li data-v-6e9f755f>• 愿意互加友链</li><li data-v-6e9f755f>• 提供网站名称、描述和头像</li></ul></div><div class="mt-4 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg" data-v-6e9f755f><h4 class="font-medium text-gray-900 dark:text-gray-100 mb-2" data-v-6e9f755f>其他联系方式：</h4><div class="space-y-1 text-sm text-gray-600 dark:text-gray-400" data-v-6e9f755f><p data-v-6e9f755f><strong data-v-6e9f755f>邮箱：</strong> nolramqetyu575@gmail.com</p></div></div>',2))]),s("div",Pe,[s("h3",He,[t(a,{class:"mr-2"},{default:l(()=>[t(i(le))]),_:1}),e[8]||(e[8]=m(" 友链统计 ",-1))]),s("div",Je,[s("div",We,[s("div",Te,j(p.value),1),e[9]||(e[9]=s("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"友链总数",-1))]),s("div",Ke,[s("div",Oe,j(c.value),1),e[10]||(e[10]=s("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"活跃友链",-1))])])]),s("div",Qe,[s("h3",Xe,[t(a,{class:"mr-2"},{default:l(()=>[t(i(oe))]),_:1}),e[11]||(e[11]=m(" 快速导航 ",-1))]),s("div",Ye,[t(w,{to:"/home",class:"flex items-center p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"},{default:l(()=>[t(a,{class:"mr-2 text-primary"},{default:l(()=>[t(i(re))]),_:1}),e[12]||(e[12]=s("span",{class:"text-gray-700 dark:text-gray-300"},"返回首页",-1))]),_:1}),t(w,{to:"/articles",class:"flex items-center p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"},{default:l(()=>[t(a,{class:"mr-2 text-primary"},{default:l(()=>[t(i(ne))]),_:1}),e[13]||(e[13]=s("span",{class:"text-gray-700 dark:text-gray-300"},"浏览文章",-1))]),_:1}),t(w,{to:"/about",class:"flex items-center p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"},{default:l(()=>[t(a,{class:"mr-2 text-primary"},{default:l(()=>[t(i(de))]),_:1}),e[14]||(e[14]=s("span",{class:"text-gray-700 dark:text-gray-300"},"关于我们",-1))]),_:1})])])])])]),t(Ce,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=n=>y.value=n),onSuccess:f},null,8,["modelValue"])])}}},st=A(Ze,[["__scopeId","data-v-6e9f755f"]]);export{st as default};
