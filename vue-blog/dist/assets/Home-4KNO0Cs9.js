import{c as g,o as m,J as C,F as P,n as j,u as V,g as E,i as M,r as h,j as W,l as z,b as e,h as y,t as v,a as n,e as k,w as x,q as F,d as L,P as O,B as Q,Q as X,I as J,K as A,R as K,S as Y,T as Z,f as U,k as D,U as H,D as ee,s as te,V as se,W as ae,O as oe,z as ie}from"./index-cinz6B6s.js";import{a as le,b as re,g as ne}from"./article-DZlkEKLi.js";import{_ as ce}from"./ArticleCard-vP8TQmsj.js";import{a as de}from"./avatar-Br5af8Id.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ue={class:"space-y-6"},me={key:0,class:"text-center py-12 text-gray-500 dark:text-gray-400"},pe={__name:"ArticleList",props:{articles:{type:Array,default:()=>[]}},setup(w){const p=V(),f=d=>{const u=d.slug||d.id;p.push({name:"ArticleDetail",params:{id:u}})};return(d,u)=>(m(),g("div",ue,[(m(!0),g(P,null,j(w.articles,c=>(m(),E(ce,{key:c.id,article:c,onClick:f},null,8,["article"]))),128)),w.articles.length===0?(m(),g("div",me," 暂无文章 ")):C("",!0)]))}},fe={class:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-lg"},_e={class:"text-center"},ge=["src"],he={class:"flex justify-center space-x-4 mb-4"},ve={class:"text-center"},ye={class:"text-2xl font-bold text-primary"},xe={class:"text-center"},we={class:"text-2xl font-bold text-primary"},ke={class:"text-center"},be={class:"text-2xl font-bold text-primary"},Ae={class:"space-y-2"},Ce=["href"],$e=["href"],Te={__name:"UserCard",setup(w){const p=M(),d=de,u=h({articleCount:0,totalViewCount:0,totalLikeCount:0}),c=W(()=>p.userInfo||{username:"Hazenix",bio:"心有所向，何惧山海",github:"https://github.com/HazeHacker",email:"L3542495583@outlook.com"}),l=async()=>{try{const a=await le.getArticleList();if(a&&a.code===200&&a.data){let t=[];Array.isArray(a.data)?t=a.data:a.data.list&&Array.isArray(a.data.list)?t=a.data.list:Array.isArray(a.data.records)?t=a.data.records:Array.isArray(a.data)?t=a.data:t=[],t=t.filter(s=>s.id!==1&&s.id!=="1"),u.value={articleCount:t.length,totalViewCount:t.reduce((s,i)=>s+(i.viewCount||0),0),totalLikeCount:t.reduce((s,i)=>s+(i.likeCount||0),0)}}}catch{}};return z(()=>{l()}),(a,t)=>{const s=L("el-icon");return m(),g("div",fe,[e("div",_e,[e("img",{src:y(d),alt:"User avatar",class:"w-20 h-20 rounded-full mx-auto mb-4"},null,8,ge),t[5]||(t[5]=e("h3",{class:"text-xl font-bold text-gray-900 dark:text-white mb-2"}," Hazenix ",-1)),t[6]||(t[6]=e("p",{class:"text-gray-600 dark:text-gray-400 mb-4"}," 心有所向，何惧山海 ",-1)),e("div",he,[e("div",ve,[e("div",ye,v(u.value.articleCount),1),t[0]||(t[0]=e("div",{class:"text-sm text-gray-500"},"文章",-1))]),e("div",xe,[e("div",we,v(u.value.totalViewCount),1),t[1]||(t[1]=e("div",{class:"text-sm text-gray-500"},"浏览",-1))]),e("div",ke,[e("div",be,v(u.value.totalLikeCount),1),t[2]||(t[2]=e("div",{class:"text-sm text-gray-500"},"点赞",-1))])]),e("div",Ae,[c.value?.github?(m(),g("a",{key:0,href:c.value.github,target:"_blank",class:"block text-sm text-gray-600 dark:text-gray-400 hover:text-primary"},[n(s,{class:"mr-1"},{default:x(()=>[n(y(F))]),_:1}),t[3]||(t[3]=k(" GitHub ",-1))],8,Ce)):C("",!0),c.value?.email?(m(),g("a",{key:1,href:`mailto:${c.value.email}`,class:"block text-sm text-gray-600 dark:text-gray-400 hover:text-primary"},[n(s,{class:"mr-1"},{default:x(()=>[n(y(O))]),_:1}),t[4]||(t[4]=k(" 联系我 ",-1))],8,$e)):C("",!0)])])])}}},Se={class:"popular-articles"},Le={class:"section-header"},ze={class:"section-title"},Ie={class:"articles-list"},Ve=["onClick"],Be={class:"article-rank"},qe={class:"article-content"},De={class:"article-title"},He={class:"article-meta"},Pe={class:"meta-item"},je={class:"meta-item"},Ee={class:"meta-item"},Me={key:0,class:"empty-state"},Ue={__name:"PopularArticles",setup(w){const p=V(),f=h(!1),d=h([]),u=async()=>{f.value=!0;try{const l=await re({limit:10,timeRange:"week"});let a=[];l&&l.data?Array.isArray(l.data)?a=l.data:l.data.records?a=l.data.records:l.data.list?a=l.data.list:Array.isArray(l.data)?a=l.data:a=[]:a=[],d.value=a.filter(t=>!(t.id===1||t.id==="1"||t.status!==0&&t.status!=="0"))}catch{A.error("加载热门文章失败"),d.value=[]}finally{f.value=!1}},c=l=>{if(typeof l=="object"&&l!==null){const a=l.slug||l.id;p.push({name:"ArticleDetail",params:{id:a}})}else p.push({name:"ArticleDetail",params:{id:l}})};return z(()=>{u()}),(l,a)=>{const t=L("el-icon"),s=L("el-empty"),i=J("loading");return m(),g("div",Se,[e("div",Le,[e("h3",ze,[n(t,{class:"mr-2"},{default:x(()=>[n(y(X))]),_:1}),a[0]||(a[0]=k(" 热门文章 ",-1))])]),Q((m(),g("div",Ie,[(m(!0),g(P,null,j(d.value,(o,r)=>(m(),g("div",{key:o.id,class:"article-item",onClick:_=>c(o)},[e("div",Be,v(r+1),1),e("div",qe,[e("h4",De,v(o.title),1),e("div",He,[e("span",Pe,[n(t,null,{default:x(()=>[n(y(K))]),_:1}),k(" "+v(o.viewCount||0),1)]),e("span",je,[n(t,null,{default:x(()=>[n(y(Y))]),_:1}),k(" "+v(o.likeCount||0),1)]),e("span",Ee,[n(t,null,{default:x(()=>[n(y(Z))]),_:1}),k(" "+v(o.commentCount||0),1)])])])],8,Ve))),128))])),[[i,f.value]]),!f.value&&d.value.length===0?(m(),g("div",Me,[n(s,{description:"暂无热门文章","image-size":80})])):C("",!0)])}}},Ge=G(Ue,[["__scopeId","data-v-a29ab860"]]),Re={class:"theme-guide-content"},Ne={class:"flex items-center gap-2 mb-2"},We={__name:"ThemeGuide",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(w,{emit:p}){const f=w,d=p,u=U(),c=h(f.modelValue),l=h(null),a=h({}),t=h({}),s=async()=>{await oe();const o=document.querySelector("header");if(!o)return;let r=o.querySelector(".theme-toggle-button");if(!r){const _=o.querySelectorAll(".el-button");_.length>0&&(r=_[_.length-1])}if(r){const _=r.getBoundingClientRect(),$=260,T=120,b=40;let S=_.top-T-b-10;const I=Math.max(8,window.innerWidth-_.right-8);S<8&&(S=8);const R=_.left+_.width/2,N=window.innerWidth-I-$,B=R-N-b/2+17,q=6;a.value={top:`${S}px`,right:`${I}px`,zIndex:1e4},t.value={position:"absolute",top:`${q}px`,left:`${B}px`,width:`${b}px`,height:`${b}px`,zIndex:9999},console.log("Theme guide position:",{tooltipTop:S,tooltipRight:I,arrowTop:q,arrowLeft:B,tooltipHeight:T})}else a.value={top:"70px",right:"16px",zIndex:1e4},t.value={position:"absolute",top:"135px",left:"50%",transform:"translateX(-50%)",width:"40px",height:"40px",zIndex:9999}};D(()=>f.modelValue,async o=>{c.value=o,o?(await s(),window.addEventListener("resize",s),window.addEventListener("scroll",s,!0)):(window.removeEventListener("resize",s),window.removeEventListener("scroll",s,!0))}),D(()=>u.isDark,o=>{!o&&c.value&&i()});const i=()=>{c.value=!1,d("update:modelValue",!1),window.removeEventListener("resize",s),window.removeEventListener("scroll",s,!0)};return z(()=>{c.value&&s()}),(o,r)=>{const _=L("el-icon");return m(),E(ae,{to:"body"},[n(se,{name:"fade"},{default:x(()=>[c.value?(m(),g("div",{key:0,class:"fixed inset-0 z-[9999]",onClick:i,style:{"pointer-events":"auto"}},[r[5]||(r[5]=e("div",{class:"absolute inset-0 bg-black/40 backdrop-blur-sm"},null,-1)),e("div",{ref_key:"guideContainer",ref:l,class:"absolute",style:H([a.value,{"pointer-events":"none"}])},[e("div",{class:"relative flex items-center justify-center",style:H([t.value,{"pointer-events":"none"}])},[...r[1]||(r[1]=[e("div",{class:"absolute w-full h-full rounded-full bg-yellow-500/20 animate-ping"},null,-1),e("div",{class:"absolute animate-bounce-horizontal"},[e("svg",{class:"w-8 h-8 text-yellow-500 drop-shadow-lg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M13 7l5 5m0 0l-5 5m5-5H6"})])],-1)])],4),e("div",{class:"theme-guide-tooltip",onClick:r[0]||(r[0]=ee(()=>{},["stop"])),style:{"pointer-events":"auto","margin-top":"47px"}},[e("button",{onClick:i,class:"absolute top-2 right-2 w-6 h-6 flex items-center justify-center rounded-full transition-colors theme-guide-close-btn","aria-label":"关闭引导"},[...r[2]||(r[2]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])]),e("div",Re,[e("div",Ne,[n(_,{class:"text-yellow-500 text-lg"},{default:x(()=>[n(y(te))]),_:1}),r[3]||(r[3]=e("span",{class:"theme-guide-title"}," 切换主题 ",-1))]),r[4]||(r[4]=e("p",{class:"theme-guide-text"}," 点击右上角的主题按钮可以切换到白色模式 ",-1))])])],4)])):C("",!0)]),_:1})])}}},Fe=G(We,[["__scopeId","data-v-7ab78819"]]),Oe={class:"py-16 md:py-24"},Qe={class:"flex flex-col md:flex-row justify-between items-start gap-12"},Xe={class:"w-full md:w-1/3 mt-12 md:mt-0"},Je={class:"mt-24 grid grid-cols-1 lg:grid-cols-3 gap-8"},Ke={class:"lg:col-span-2"},Ye={class:"lg:col-span-1"},Ze={class:"space-y-8"},lt={__name:"Home",setup(w){const p=ie(),f=V(),d=M(),u=U(),c=h([]),l=h(!1),a=async()=>{const t=p.query.code;let s=p.query.source||sessionStorage.getItem("oauth_source")||null;if(t&&!window._oauthCallbackProcessing){window._oauthCallbackProcessing=!0;try{s==="github"?(await d.githubLogin(t),A.success("GitHub登录成功"),sessionStorage.removeItem("oauth_source")):s==="google"?(await d.googleLogin(t),A.success("Google登录成功"),sessionStorage.removeItem("oauth_source")):(await d.githubLogin(t),A.success("登录成功"),sessionStorage.removeItem("oauth_source"));try{await d.getUserInfo()}catch{}const i={...p.query};delete i.code,delete i.source,f.replace({path:"/home",query:i})}catch(i){A.error("第三方登录失败: "+(i.message||"未知错误")),sessionStorage.removeItem("oauth_source");const o={...p.query};delete o.code,delete o.source,f.replace({path:"/home",query:o})}finally{window._oauthCallbackProcessing=!1}}};return z(async()=>{await a(),p.query.fromIndex==="true"&&(u.isDark||u.toggleTheme(),f.replace({path:"/home",query:{}}),setTimeout(()=>{u.isDark&&(l.value=!0)},1e3));try{const s=await ne({status:"0",page:1,pageSize:6});let i=[];s&&s.data?Array.isArray(s.data)?i=s.data:s.data.records?i=s.data.records:s.data.list?i=s.data.list:i=Array.isArray(s.data)?s.data:[s.data]:i=[],i=i.filter(o=>o.id!==1&&o.id!=="1"),i.sort((o,r)=>{const _=o.isTop===1||o.isTop===!0,$=r.isTop===1||r.isTop===!0;if(_&&!$)return-1;if(!_&&$)return 1;const T=new Date(o.createTime||o.createdAt||0).getTime();return new Date(r.createTime||r.createdAt||0).getTime()-T}),c.value=i.slice(0,6)}catch{c.value=[{id:1,title:"服务器故障，欢迎联系我修复",summary:"...",author:"Hazenix",createTime:"2025-12-19",viewCount:100,tags:[{id:1,name:"运维"},{id:2,name:"后端"}]},{id:2,title:"也可能是网络问题",summary:"..",author:"Hazenix",createTime:"2025-12-19",viewCount:85,tags:[{id:3,name:"运维"},{id:4,name:"后端"}]}]}}),(t,s)=>(m(),g("div",Oe,[n(Fe,{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=i=>l.value=i)},null,8,["modelValue"]),e("div",Qe,[s[1]||(s[1]=e("div",{class:"md:w-2/3"},[e("h1",{class:"text-5xl md:text-6xl font-bold text-gray-900 dark:text-white"}," Hazenix's Blog "),e("p",{class:"mt-4 text-2xl md:text-3xl text-primary font-semibold"}," Only those who keep walking light up the long road of time "),e("p",{class:"mt-6 text-lg text-gray-500 dark:text-gray-400"}," 我会一直走，走到灯火通明 ")],-1)),e("div",Xe,[n(Te)])]),e("div",Je,[e("div",Ke,[s[2]||(s[2]=e("h2",{class:"text-3xl font-bold mb-8"},"最新文章",-1)),n(pe,{articles:c.value},null,8,["articles"])]),e("div",Ye,[e("div",Ze,[n(Ge)])])])]))}};export{lt as default};
