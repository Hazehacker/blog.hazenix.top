import{i as q,r as t,j as A,c as _,B as T,o as x,b as o,l as c,d as j,a,w as r,f as m,K as I,E as i,L as K,u as J,x as O,D as P}from"./index-BBqYyNLz.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const W={class:"login-card"},X={key:0,class:"login-method-selection"},Y={class:"social-login-buttons"},Z=["disabled"],$=["disabled"],ee={key:1,class:"email-login-form"},oe={class:"captcha-container"},le={class:"captcha-text"},se={__name:"LoginDialog",setup(ae,{expose:L}){const f=J(),B=O(),G=q(),v=t(),h=t(!1),b=t(!1),w=t(!1),k=t(!1),d=t(!1),y=t(""),s=t({email:"",password:"",captcha:""}),H={email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],captcha:[{required:!0,message:"请输入验证码",trigger:"blur"}]},C=()=>{const l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let e="";for(let n=0;n<5;n++)e+=l.charAt(Math.floor(Math.random()*l.length));y.value=e},V=()=>{C()},z=()=>{d.value=!0,C()},D=()=>{d.value=!1},E=()=>{k.value=!0,d.value=!1,document.body.style.overflow="hidden"},u=()=>{k.value=!1,d.value=!1,document.body.style.overflow="",s.value={email:"",password:"",captcha:""},v.value&&v.value.resetFields()},F=()=>{u(),f.push("/register")},U=async()=>{try{if(await v.value.validate(),s.value.captcha.toLowerCase()!==y.value.toLowerCase()){i.error("验证码错误"),V();return}h.value=!0;const l={email:s.value.email,password:s.value.password};await G.login(l),i.success("登录成功"),u();const e=B?.query?.redirect;typeof e=="string"&&e?f.replace(e):f.replace("/home")}catch(l){l.message?i.error(l.message):i.error("登录失败"),V()}finally{h.value=!1}},N=async()=>{try{w.value=!0,i.info("GitHub登录功能正在开发中...")}catch(l){i.error("GitHub登录失败"),console.error("GitHub login error:",l)}finally{w.value=!1}},R=async()=>{try{b.value=!0;const e=(await K()).data;window.location.href=e}catch(l){i.error("获取Google授权链接失败"),console.error("Google login error:",l)}finally{b.value=!1}};return A(()=>{C()}),L({open:E,close:u}),(l,e)=>{const n=m("el-input"),g=m("el-form-item"),M=m("el-button"),S=m("el-form");return k.value?(x(),_("div",{key:0,class:"login-dialog-overlay",onClick:u},[o("div",{class:"login-dialog-container",onClick:e[3]||(e[3]=I(()=>{},["stop"]))},[o("div",W,[o("button",{onClick:u,class:"close-btn"},[...e[4]||(e[4]=[o("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])]),e[16]||(e[16]=o("div",{class:"login-header"},[o("h1",{class:"login-title"},"登录到 Hazenix's Blog "),o("p",{class:"login-subtitle"},"欢迎回来! 请登录您的账号")],-1)),d.value?(x(),_("div",ee,[o("button",{onClick:D,class:"back-btn"},[...e[9]||(e[9]=[o("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),c(" 返回 ",-1)])]),a(S,{model:s.value,rules:H,ref_key:"formRef",ref:v,class:"login-form"},{default:r(()=>[a(g,{prop:"email"},{default:r(()=>[e[10]||(e[10]=o("label",{class:"form-label"},"邮箱",-1)),a(n,{modelValue:s.value.email,"onUpdate:modelValue":e[0]||(e[0]=p=>s.value.email=p),placeholder:"your@email.com",class:"form-input"},null,8,["modelValue"])]),_:1}),a(g,{prop:"password"},{default:r(()=>[e[11]||(e[11]=o("label",{class:"form-label"},"密码",-1)),a(n,{modelValue:s.value.password,"onUpdate:modelValue":e[1]||(e[1]=p=>s.value.password=p),type:"password",placeholder:"........",class:"form-input"},null,8,["modelValue"])]),_:1}),a(g,{prop:"captcha"},{default:r(()=>[e[12]||(e[12]=o("label",{class:"form-label"},"验证码",-1)),o("div",oe,[a(n,{modelValue:s.value.captcha,"onUpdate:modelValue":e[2]||(e[2]=p=>s.value.captcha=p),placeholder:"输入验证码",class:"captcha-input"},null,8,["modelValue"]),o("div",{class:"captcha-image",onClick:V},[o("span",le,P(y.value),1)])])]),_:1}),e[15]||(e[15]=o("div",{class:"forgot-password"},[o("a",{href:"#",class:"forgot-link"},[c("忘记密码? "),o("span",{class:"underline"},"点击这里重置")])],-1)),a(g,null,{default:r(()=>[a(M,{type:"primary",class:"login-btn",onClick:U,loading:h.value},{default:r(()=>[...e[13]||(e[13]=[c(" 登录 ",-1)])]),_:1},8,["loading"])]),_:1}),a(g,null,{default:r(()=>[a(M,{class:"register-btn",onClick:F},{default:r(()=>[...e[14]||(e[14]=[c(" 没有账号? 注册 ",-1)])]),_:1})]),_:1})]),_:1},8,["model"])])):(x(),_("div",X,[o("button",{class:"email-login-btn",onClick:z},[...e[5]||(e[5]=[o("svg",{class:"email-icon",viewBox:"0 0 24 24",width:"20",height:"20"},[o("path",{fill:"currentColor",d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})],-1),c(" 通过邮箱 登录 ",-1)])]),e[8]||(e[8]=o("div",{class:"divider"},[o("span",{class:"divider-text"},"或通过社交账号登录")],-1)),o("div",Y,[o("button",{class:"github-login-btn",onClick:N,disabled:w.value},[...e[6]||(e[6]=[o("svg",{class:"github-icon",viewBox:"0 0 24 24",width:"20",height:"20"},[o("path",{fill:"currentColor",d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})],-1),c(" GitHub ",-1)])],8,Z),o("button",{class:"google-login-btn",onClick:R,disabled:b.value},[...e[7]||(e[7]=[j('<svg class="google-icon" viewBox="0 0 24 24" width="20" height="20" data-v-e579ce51><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" data-v-e579ce51></path><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" data-v-e579ce51></path><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" data-v-e579ce51></path><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" data-v-e579ce51></path></svg> Google ',2)])],8,$)])]))])])])):T("",!0)}}},ie=Q(se,[["__scopeId","data-v-e579ce51"]]);export{ie as L};
