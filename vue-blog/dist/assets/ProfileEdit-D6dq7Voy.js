import{r as f,S as w,o as x,c as i,f as s,e as k,J as v,B as d,ag as l,G as P,H as a,h,b as u}from"./index-BjRrW_j8.js";import{u as U}from"./user-CHPnUmjS.js";import{_ as V}from"./LoadingSpinner-RrWrbirh.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";const I={class:"profile-edit"},B={class:"container mx-auto px-4 py-8"},E={class:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6"},M={key:0,class:"flex justify-center py-8"},$={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},D={class:"mt-6"},j={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},N={class:"flex justify-end space-x-4"},R=["disabled"],C={__name:"ProfileEdit",setup(F){const g=h(),b=U(),m=f(!0),n=f(!1),r=w({nickname:"",email:"",bio:"",currentPassword:"",newPassword:"",confirmPassword:""}),p=async()=>{try{await b.getUserInfo();const t=b.userInfo||{};r.nickname=t.nickname||"",r.email=t.email||"",r.bio=t.bio||""}catch(t){console.error("获取用户信息失败:",t),a.error("获取用户信息失败")}finally{m.value=!1}},c=()=>{const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(r.email&&!t.test(r.email))return a.error("请输入有效的邮箱地址"),!1;if(r.currentPassword||r.newPassword||r.confirmPassword){if(!r.currentPassword)return a.error("请输入当前密码"),!1;if(!r.newPassword)return a.error("请输入新密码"),!1;if(r.newPassword.length<6)return a.error("新密码长度不能少于6位"),!1;if(r.newPassword!==r.confirmPassword)return a.error("两次输入的密码不一致"),!1}return!0},y=async()=>{if(c()){n.value=!0;try{const t={nickname:r.nickname,email:r.email,bio:r.bio};r.currentPassword&&r.newPassword&&(t.currentPassword=r.currentPassword,t.newPassword=r.newPassword),a.success("资料更新成功"),g.push("/profile")}catch(t){console.error("更新资料失败:",t),a.error("更新资料失败，请重试")}finally{n.value=!1}}};return x(()=>{p()}),(t,e)=>(u(),i("div",I,[s("div",B,[s("div",E,[e[15]||(e[15]=s("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-6"}," 编辑资料 ",-1)),m.value?(u(),i("div",M,[k(V)])):(u(),i("form",{key:1,onSubmit:v(y,["prevent"]),class:"space-y-6"},[s("div",null,[e[10]||(e[10]=s("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-4"}," 基本信息 ",-1)),s("div",$,[s("div",null,[e[7]||(e[7]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 昵称 ",-1)),d(s("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>r.nickname=o),type:"text",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"请输入昵称"},null,512),[[l,r.nickname]])]),s("div",null,[e[8]||(e[8]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 邮箱 ",-1)),d(s("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>r.email=o),type:"email",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"请输入邮箱"},null,512),[[l,r.email]])])]),s("div",D,[e[9]||(e[9]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 个人简介 ",-1)),d(s("textarea",{"onUpdate:modelValue":e[2]||(e[2]=o=>r.bio=o),rows:"4",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"请输入个人简介"},null,512),[[l,r.bio]])])]),s("div",null,[e[14]||(e[14]=s("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-4"}," 密码修改 ",-1)),s("div",j,[s("div",null,[e[11]||(e[11]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 当前密码 ",-1)),d(s("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>r.currentPassword=o),type:"password",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"请输入当前密码"},null,512),[[l,r.currentPassword]])]),s("div",null,[e[12]||(e[12]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 新密码 ",-1)),d(s("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>r.newPassword=o),type:"password",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"请输入新密码"},null,512),[[l,r.newPassword]])]),s("div",null,[e[13]||(e[13]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 确认新密码 ",-1)),d(s("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>r.confirmPassword=o),type:"password",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"请确认新密码"},null,512),[[l,r.confirmPassword]])])])]),s("div",N,[s("button",{type:"button",onClick:e[6]||(e[6]=o=>t.$router.go(-1)),class:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"}," 取消 "),s("button",{type:"submit",disabled:n.value,class:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},P(n.value?"保存中...":"保存修改"),9,R)])],32))])])]))}},T=S(C,[["__scopeId","data-v-28231656"]]);export{T as default};
