import{_ as U}from"./githubLogo-CVgsuQiF.js";import{i as C,r as p,c as P,o as R,a as s,w as l,f as n,u as k,b as d,l as w,E as i,am as G}from"./index-BBqYyNLz.js";const q={class:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900"},E={class:"flex items-center justify-center space-x-4 mt-4"},j={__name:"Register",setup(H){const c=k(),_=C(),f=p(),m=p(!1),r=p({username:"",email:"",password:"",confirmPassword:""}),v={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(a,e,o)=>{e!==r.value.password?o(new Error("两次输入的密码不一致")):o()},trigger:"blur"}]},b=async()=>{await f.value.validate(),m.value=!0;try{const a={username:r.value.username,email:r.value.email,password:r.value.password};await _.register(a),i.success("注册成功"),c.push("/")}catch(a){i.error(a.message||"注册失败")}finally{m.value=!1}},y=()=>{c.push("/")},V=async()=>{try{const a=await G();a.code===200?window.location.href=a.data:i.error(a.msg||"获取GitHub授权URL失败")}catch(a){i.error(a.message||"获取GitHub授权URL失败")}};return(a,e)=>{const o=n("el-input"),u=n("el-form-item"),g=n("el-button"),x=n("el-form"),h=n("el-card");return R(),P("div",q,[s(h,{class:"w-full max-w-md"},{header:l(()=>[...e[4]||(e[4]=[d("h2",{class:"text-2xl font-bold text-center"},"用户注册",-1)])]),default:l(()=>[s(x,{model:r.value,rules:v,ref_key:"formRef",ref:f},{default:l(()=>[s(u,{prop:"username"},{default:l(()=>[s(o,{modelValue:r.value.username,"onUpdate:modelValue":e[0]||(e[0]=t=>r.value.username=t),placeholder:"用户名"},null,8,["modelValue"])]),_:1}),s(u,{prop:"email"},{default:l(()=>[s(o,{modelValue:r.value.email,"onUpdate:modelValue":e[1]||(e[1]=t=>r.value.email=t),placeholder:"邮箱"},null,8,["modelValue"])]),_:1}),s(u,{prop:"password"},{default:l(()=>[s(o,{modelValue:r.value.password,"onUpdate:modelValue":e[2]||(e[2]=t=>r.value.password=t),type:"password",placeholder:"密码"},null,8,["modelValue"])]),_:1}),s(u,{prop:"confirmPassword"},{default:l(()=>[s(o,{modelValue:r.value.confirmPassword,"onUpdate:modelValue":e[3]||(e[3]=t=>r.value.confirmPassword=t),type:"password",placeholder:"确认密码"},null,8,["modelValue"])]),_:1}),s(u,null,{default:l(()=>[s(g,{type:"primary",class:"w-full",onClick:b,loading:m.value},{default:l(()=>[...e[5]||(e[5]=[w(" 注册 ",-1)])]),_:1},8,["loading"])]),_:1}),d("div",E,[s(g,{type:"default",onClick:V},{default:l(()=>[...e[6]||(e[6]=[d("img",{src:U,alt:"GitHub",class:"w-6 h-6 mr-2"},null,-1),w(" GitHub 登录 ",-1)])]),_:1})])]),_:1},8,["model"]),d("div",{class:"text-center"},[d("span",{class:"text-primary cursor-pointer",onClick:y},"已有账号？立即登录")])]),_:1})])}}};export{j as default};
