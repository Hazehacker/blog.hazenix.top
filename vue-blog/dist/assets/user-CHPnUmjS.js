import{W as o,ai as s,aa as n,aj as a,ak as r}from"./index-BjRrW_j8.js";function u(t){return o({url:"/user/user/login",method:"post",data:t})}function i(t){return o({url:"/user/user/register",method:"post",data:t})}function g(){return o({url:"/auth/userinfo",method:"get"})}function h(){return o({url:"/user/user/google/url",method:"get"})}function l(t){return o({url:"/user/user/google/callback",method:"get",params:{code:t}})}const d=s("user",{state:()=>({token:n()||"",userInfo:null}),actions:{async login(t){const e=await u(t);if(e.code===200)this.token=e.data.token,r(e.data.token),this.userInfo=e.data;else throw new Error(e.msg||"登录失败")},async register(t){const e=await i(t);if(e.code===200)this.token=e.data.token,r(e.data.token),this.userInfo=e.data;else throw new Error(e.msg||"注册失败")},async getUserInfo(){const t=await g();if(t.code===200)this.userInfo=t.data;else throw new Error(t.msg||"获取用户信息失败")},async googleLogin(t){const e=await l(t);if(e.code===200)this.token=e.data.token,r(e.data.token),this.userInfo=e.data;else throw new Error(e.msg||"Google登录失败")},logout(){this.token="",this.userInfo=null,a()}}});export{h as g,d as u};
