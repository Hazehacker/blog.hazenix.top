# 友链申请接口文档

## 接口概述

友链申请接口允许用户通过前端表单提交友情链接申请，管理员可以在后台审核这些申请。

## 接口详情

### 申请友链

**接口地址：** `POST /user/links/apply`

**请求方法：** POST

**认证要求：** 不需要

**Content-Type：** `application/json`

## 请求参数

### 请求体参数

| 参数名 | 类型 | 必填 | 长度限制 | 说明 | 示例 |
|--------|------|------|----------|------|------|
| name | string | 是 | 2-48字符 | 网站名称 | "Vue.js官方文档" |
| description | string | 否 | 最大255字符 | 网站描述 | "渐进式JavaScript框架" |
| url | string | 是 | 最大255字符 | 网站地址，必须是有效URL | "https://vuejs.org" |
| avatar | string | 否 | 最大600字符 | 友链头像URL | "https://vuejs.org/images/logo.png" |

### 请求示例

```json
{
  "name": "Vue.js官方文档",
  "description": "渐进式JavaScript框架，用于构建用户界面",
  "url": "https://vuejs.org",
  "avatar": "https://vuejs.org/images/logo.png"
}
```

## 响应格式

### 成功响应

**HTTP状态码：** 200

**响应体：**

```json
{
  "code": 200,
  "msg": "友链申请提交成功，请等待审核",
  "data": {
    "id": 3,
    "name": "Vue.js官方文档",
    "description": "渐进式JavaScript框架，用于构建用户界面",
    "url": "https://vuejs.org",
    "avatar": "https://vuejs.org/images/logo.png",
    "status": 1,
    "createTime": "2024-01-01T12:00:00Z"
  }
}
```

**响应字段说明：**

| 字段名 | 类型 | 说明 |
|--------|------|------|
| code | int | 响应状态码，200表示成功 |
| msg | string | 响应消息 |
| data | object | 响应数据 |
| data.id | int | 友链ID |
| data.name | string | 网站名称 |
| data.description | string | 网站描述 |
| data.url | string | 网站地址 |
| data.avatar | string | 友链头像URL |
| data.status | int | 状态：0-正常，1-审核中 |
| data.createTime | string | 创建时间（ISO 8601格式） |

### 错误响应

#### 参数验证错误

**HTTP状态码：** 400

**响应示例：**

```json
{
  "code": 400,
  "msg": "网站名称不能为空",
  "data": null
}
```

```json
{
  "code": 400,
  "msg": "网站地址格式不正确",
  "data": null
}
```

```json
{
  "code": 400,
  "msg": "网站名称长度不能超过48个字符",
  "data": null
}
```

```json
{
  "code": 400,
  "msg": "网站描述长度不能超过255个字符",
  "data": null
}
```

```json
{
  "code": 400,
  "msg": "友链头像URL长度不能超过600个字符",
  "data": null
}
```

#### 服务器错误

**HTTP状态码：** 500

**响应示例：**

```json
{
  "code": 500,
  "msg": "服务器内部错误",
  "data": null
}
```

## 业务规则

### 1. 数据验证规则

- **网站名称**：
  - 必填字段
  - 长度：2-48个字符
  - 不能包含特殊字符（如：<、>、&、'、"）

- **网站描述**：
  - 可选字段
  - 最大长度：255个字符
  - 支持中英文、数字、标点符号

- **网站地址**：
  - 必填字段
  - 必须是有效的URL格式
  - 必须以 http:// 或 https:// 开头
  - 最大长度：255个字符

- **友链头像**：
  - 可选字段
  - 必须是有效的图片URL
  - 支持的格式：JPG、PNG、GIF、WebP
  - 最大长度：600个字符

### 2. 状态管理

- 用户提交的友链申请默认状态为 `1`（审核中）
- 只有管理员可以将状态改为 `0`（正常）或 `2`（拒绝）
- 只有状态为 `0` 的友链才会在前台显示

### 3. 重复检查

- 系统会检查是否已存在相同的网站地址
- 如果存在，返回相应的错误信息

## 调用示例

### JavaScript/Axios 示例

```javascript
// 申请友链
const applyLink = async (linkData) => {
  try {
    const response = await axios.post('/user/links/apply', linkData, {
      headers: {
        'Content-Type': 'application/json'
      }
    })
    return response.data
  } catch (error) {
    console.error('申请友链失败:', error)
    throw error
  }
}

// 使用示例
const linkData = {
  name: "Vue.js官方文档",
  description: "渐进式JavaScript框架，用于构建用户界面",
  url: "https://vuejs.org",
  avatar: "https://vuejs.org/images/logo.png"
}

applyLink(linkData)
  .then(response => {
    console.log('申请成功:', response)
    // 显示成功消息
    alert('友链申请提交成功，请等待审核')
  })
  .catch(error => {
    console.error('申请失败:', error)
    // 显示错误消息
    alert('申请失败：' + error.response.data.msg)
  })
```

### Vue.js 示例

```javascript
// 在Vue组件中使用
export default {
  data() {
    return {
      form: {
        name: '',
        description: '',
        url: '',
        avatar: ''
      }
    }
  },
  methods: {
    async submitApply() {
      try {
        const response = await this.$http.post('/user/links/apply', this.form)
        this.$message.success('友链申请提交成功，请等待审核')
        this.resetForm()
      } catch (error) {
        this.$message.error('申请失败：' + error.response.data.msg)
      }
    },
    resetForm() {
      this.form = {
        name: '',
        description: '',
        url: '',
        avatar: ''
      }
    }
  }
}
```

## 注意事项

1. **URL验证**：确保提交的网站地址是有效的URL格式
2. **图片处理**：建议使用CDN或稳定的图片服务
3. **字符编码**：所有文本字段都使用UTF-8编码
4. **错误处理**：前端应该妥善处理各种错误情况
5. **用户体验**：建议在提交后显示明确的反馈信息

## 相关接口

- `GET /user/links` - 获取友链列表
- `POST /user/common/upload` - 上传图片文件（用于头像上传）

## 更新日志

- **v1.0.0** (2024-01-01): 初始版本，支持基本的友链申请功能
